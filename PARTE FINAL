def fretes_pessoas_juridicas_por_mes(cursor, mes, ano):
    try:
        query = """
            SELECT
                f.num_conhecimento AS num_frete,
                pj.razao_social AS empresa,
                pj.cnpj,
                CASE
                    WHEN f.remetente = c.cod_cliente THEN 'Remetente'
                    WHEN f.destinatario = c.cod_cliente THEN 'Destinatário'
                    ELSE 'N/A'
                END AS papel_cliente,
                func.nome_funcionario AS representante
            FROM Frete f
            JOIN Cliente c ON f.remetente = c.cod_cliente OR f.destinatario = c.cod_cliente
            JOIN Pessoa_Juridica pj ON pj.cod_cliente = c.cod_cliente
            JOIN Funcionario func ON f.num_reg_func = func.num_registro
            WHERE EXTRACT(MONTH FROM f.data_frete) = %s
              AND EXTRACT(YEAR FROM f.data_frete) = %s;
        """
        cursor.execute(query, (mes, ano))
        resultado = cursor.fetchall()
        colunas = ["Número do Frete", "Empresa", "CNPJ", "Papel do Cliente", "Representante"]
        print(tabulate(resultado, headers=colunas, tablefmt="fancy_grid"))
    except Exception as e:
        print("Erro ao listar fretes de pessoas jurídicas:", e)
